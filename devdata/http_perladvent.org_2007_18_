<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by perltidy on Tue Dec 18 20:58:39 2007 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>2007 Perl Advent Calendar: Here we come a wascrolling</title>
<link rel="stylesheet" href="../style.css" type="text/css" /></head>
<body>
<h1><a href="../">Perl Advent Calendar 2007-12</a>-18</h1>
<h2 align="center">Here we come a wascrolling</h2>
<h3 align="center">by Jerrad Pierce</h3>

<p>You've all been good little boys and girls this year haven't you?
Well, it's a special day regardless so you get your toy early this year:
<tt><a href="http://search.cpan.org/search?module=Acme::Curses::Marquee">Acme::Curses::Marquee</a></tt><sup><a href="#1">1</a></sup>.
While Marquee is very easy to use, I've committed a faux-pas and essentially
stolen the sample code form the POD. However, I did make some adapations,
as well as discover a few fatal flaws in the code. You'll need to apply
<a href="mod18.patch">this patch</a> I submitted in a bug report to get it
working; I guess it really is an under-appreciated module, eh? I deviated from
the script somewhat though. I started by removing the seemingly pointless call
to <tt>getch()</tt>. This sent the marquee spinning like a top, at which point
I realized I could lose hacky curses calls an employ <tt>Time::HiRes</tt>'s
<tt>usleep</tt> for more control over the scrolling speed.</p>

<p>If you'd like to get a feel for the results without the hassle of installing
the module and it's dependencies, then patching it, you can view a movie on a
vt100 comptaible terminal like so</p>

<pre>kringle> <a href="slowcat.pl">slowcat.pl</a> <a href="mod18.vt100">mod18.vt100</a></pre>

<p>if some combination of <tt>stty</tt> and <tt>cat</tt> doesn't do the trick
for you. You can adjust the speed by changing the baud rate (set to 3000 here),
and after you've gone through all the trouble of downloading that line of
code, or adjusting your TERM settings, you might be interested in some other
<a href="http://vt100.net/animation/">holiday cheer</a>.</p>

Finally, here's a slightly more portable version of today's example that uses
a pure perl implementation of FIGlet, by yours truly, and does not rely upon a
binary being in your <tt>PATH: <a href="mod18b.pl">mod18b.pl</a></tt>. 

<h1><a href="mod18a.pl">mod18a.pl</a></h1>
<hr />
<pre>
   1 <span class="k">use</span> <span class="w">Acme::Curses::Marquee</span><span class="sc">;</span>
   2 <span class="k">use</span> <span class="w">Curses</span><span class="sc">;</span>
   3 <span class="k">use</span> <span class="w">Time::HiRes</span> <span class="q">'usleep'</span><span class="sc">;</span>
   4 
   5 <span class="c">#Set height and width of scroll area</span>
   6 <span class="k">use</span> <span class="w">constant</span> <span class="s">{</span><span class="w">X</span><span class="cm">=&gt;</span><span class="n">80</span><span class="cm">,</span> <span class="w">Y</span><span class="cm">=&gt;</span><span class="n">9</span><span class="s">}</span><span class="sc">;</span>
   7 
   8 <span class="c">#Start your engines</span>
   9 <span class="w">initscr</span><span class="sc">;</span>
  10 
  11 <span class="c">#Create the scrolling area half-way down the standard terminal</span>
  12 <span class="c">#Unfortunately, instantiating it in the marquee maker segfaults</span>
  13 <span class="k">my</span> <span class="i">$w</span> = <span class="i">subwin</span><span class="s">(</span><span class="w">Y</span><span class="cm">,</span><span class="w">X</span><span class="cm">,</span><span class="n">8</span><span class="cm">,</span><span class="n">0</span><span class="s">)</span><span class="sc">;</span>
  14 
  15 <span class="c">#Make the marquee</span>
  16 <span class="k">my</span> <span class="i">$m</span> = <span class="w">Acme::Curses::Marquee</span><span class="w">-&gt;new</span><span class="s">(</span> <span class="w">window</span> <span class="cm">=&gt;</span> <span class="i">$w</span><span class="cm">,</span>
  17                                     <span class="w">height</span> <span class="cm">=&gt;</span> <span class="w">Y</span><span class="cm">,</span>
  18                                     <span class="w">width</span>  <span class="cm">=&gt;</span> <span class="w">X</span><span class="cm">,</span>
  19                                     <span class="w">font</span>   <span class="cm">=&gt;</span> <span class="q">'larry3d'</span><span class="cm">,</span> <span class="c">#Nyuck nyuck</span>
  20                                     <span class="w">text</span>   <span class="cm">=&gt;</span> <span class="q">'Happy Birthday Perl!'</span> <span class="s">)</span><span class="sc">;</span>
  21 <span class="c">#Wheeeee!</span>
  22 <span class="k">while</span> <span class="s">(</span><span class="n">1</span><span class="s">)</span> <span class="s">{</span>
  23   <span class="i">usleep</span><span class="s">(</span><span class="n">75_000</span><span class="s">)</span><span class="sc">;</span>
  24   <span class="i">$m</span><span class="i">-&gt;scroll</span><span class="sc">;</span>
  25 <span class="s">}</span>
</pre>

<p><a name="1">1.</a> I've had an entry on my round tuit list to create an
<tt>Acme::Curses::Marquee::Extensions</tt> module since I first stumbled
across this little nugget when I was writing my first advent calendar two
years ago.</p>

</body>
</html>
